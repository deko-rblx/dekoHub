-- Ultra Autofarm Script with Noclip and Gradient UI
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")

-- Autofarm Variables
local LP = Players.LocalPlayer
local Char = LP.Character or LP.CharacterAdded:Wait()
local HRP = Char:WaitForChild("HumanoidRootPart")
local Humanoid = Char:WaitForChild("Humanoid")
local AutofarmEnabled = false
local CurrentMap = nil
local NoclipEnabled = false
local NoclipConnection = nil

-- UI Setup
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "UltraAutofarmUI"
ScreenGui.Parent = CoreGui
ScreenGui.ResetOnSpawn = false

-- Main Window
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 350, 0, 250)
MainFrame.Position = UDim2.new(0.5, -175, 0.5, -125)
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
MainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 25)
MainFrame.BackgroundTransparency = 0.15
MainFrame.BorderSizePixel = 0
MainFrame.Parent = ScreenGui

-- Cosmic Background
local Background = Instance.new("ImageLabel")
Background.Name = "CosmicBackground"
Background.Size = UDim2.new(1, 0, 1, 0)
Background.Position = UDim2.new(0, 0, 0, 0)
Background.Image = "rbxassetid://13088277178" -- Красивое космическое изображение
Background.ScaleType = Enum.ScaleType.Tile
Background.TileSize = UDim2.new(0, 512, 0, 512)
Background.BackgroundTransparency = 1
Background.ZIndex = 0
Background.Parent = MainFrame

-- Анимация фона
local xOffset = 0
RunService.Heartbeat:Connect(function(delta)
    xOffset = (xOffset + delta * 5) % 512
    Background.Offset = Vector2.new(xOffset, 0)
end)

-- Функция создания кнопок с градиентом
local function CreateGradientButton(parent, name, size, position)
    local button = Instance.new("TextButton")
    button.Name = name
    button.Size = size
    button.Position = position
    button.Text = name
    button.Font = Enum.Font.GothamBold
    button.TextSize = 14
    button.TextColor3 = Color3.new(1, 1, 1)
    button.BackgroundTransparency = 1
    button.AutoButtonColor = false
    button.Parent = parent

    -- Gradient Frame
    local gradientFrame = Instance.new("Frame")
    gradientFrame.Name = "GradientFrame"
    gradientFrame.Size = UDim2.new(1, 0, 1, 0)
    gradientFrame.BackgroundTransparency = 0.8
    gradientFrame.BorderSizePixel = 0
    gradientFrame.ZIndex = -1
    gradientFrame.Parent = button

    -- Gradient
    local gradient = Instance.new("UIGradient")
    gradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.fromRGB(90, 20, 150)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(50, 0, 90))
    })
    gradient.Rotation = 90
    gradient.Parent = gradientFrame

    -- Corner
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 6)
    corner.Parent = gradientFrame

    -- Stroke
    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(120, 40, 180)
    stroke.Thickness = 1
    stroke.Parent = gradientFrame

    -- Hover Effects
    button.MouseEnter:Connect(function()
        TweenService:Create(gradient, TweenInfo.new(0.2), {
            Color = ColorSequence.new({
                ColorSequenceKeypoint.new(0, Color3.fromRGB(110, 40, 170)),
                ColorSequenceKeypoint.new(1, Color3.fromRGB(70, 10, 120))
            })
        }):Play()
    end)

    button.MouseLeave:Connect(function()
        TweenService:Create(gradient, TweenInfo.new(0.2), {
            Color = ColorSequence.new({
                ColorSequenceKeypoint.new(0, Color3.fromRGB(90, 20, 150)),
                ColorSequenceKeypoint.new(1, Color3.fromRGB(50, 0, 90))
            })
        }):Play()
    end)

    return button
end

-- Noclip Function
local function NoclipLoop()
    if NoclipConnection then NoclipConnection:Disconnect() end
    
    NoclipConnection = RunService.Stepped:Connect(function()
        if NoclipEnabled and Char then
            for _, part in ipairs(Char:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.CanCollide = false
                end
            end
        end
    end)
end

-- Автофарм с Noclip
local function ToggleAutofarm()
    AutofarmEnabled = not AutofarmEnabled
    NoclipEnabled = AutofarmEnabled
    
    if AutofarmEnabled then
        NoclipLoop()
        -- Запускаем фарминг
    else
        if NoclipConnection then
            NoclipConnection:Disconnect()
        end
    end
end

-- Создаем кнопку Autofarm с градиентом
local AutofarmButton = CreateGradientButton(
    MainFrame,
    "Autofarm: OFF",
    UDim2.new(0.8, 0, 0, 40),
    UDim2.new(0.1, 0, 0.3, 0)
)

AutofarmButton.MouseButton1Click:Connect(function()
    ToggleAutofarm()
    AutofarmButton.Text = AutofarmEnabled and "Autofarm: ON" or "Autofarm: OFF"
end)

-- Кнопка закрытия с градиентом
local CloseButton = CreateGradientButton(
    MainFrame,
    "X",
    UDim2.new(0, 30, 0, 30),
    UDim2.new(1, -35, 0, 5)
)

CloseButton.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
    if NoclipConnection then
        NoclipConnection:Disconnect()
    end
end)

-- Делаем окно перетаскиваемым
local dragging, dragInput, dragStart, startPos
MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

MainFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

UIS.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- Hotkey (F для включения/выключения)
UIS.InputBegan:Connect(function(input, gameProcessed)
    if input.KeyCode == Enum.KeyCode.F and not gameProcessed then
        ToggleAutofarm()
        AutofarmButton.Text = AutofarmEnabled and "Autofarm: ON" or "Autofarm: OFF"
    end
end)

print("Ultra Autofarm UI loaded! Press F to toggle.")
